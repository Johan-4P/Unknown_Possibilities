{% extends "base.html" %}
{% load static %}

{% load crispy_forms_tags %}


{% block extra_title %} | Checkout {% endblock %}

{% block content %}
<div class="container mt-5 pt-5 fade-in-section text-light">
  <h2 class="text-center mb-4">ðŸ”® Secure Your Order</h2>
  <p class="text-center">Fill in your details and confirm your items...</p>

  <div class="row">
    <!-- Checkout form -->
    <div class="col-md-6 mb-4">
      <div class="card bg-dark border-light shadow-lg p-4 h-100">
        <h4 class="mb-3">Your Details</h4>
        <form method="POST">
          {% csrf_token %}
          {{ form|crispy }}

          <button type="submit" class="btn btn-own-style w-100 mt-3">
            <i class="fas fa-magic me-1"></i>Place Order
          </button>
        </form>
      </div>
    </div>

    <!-- Order summary -->
    <div class="col-md-6 mb-4">
      <div class="card bg-secondary bg-opacity-10 border-light shadow-lg p-4 h-100">
        <h4 class="mb-3">ðŸ›’ Your Items</h4>
        {% if bag_items %}
          <ul class="list-group list-group-flush">
            {% for item in bag_items %}
              <li class="list-group-item bg-transparent text-light d-flex justify-content-between align-items-start">
                <div class="d-flex">
                  <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="me-3 rounded" style="width: 60px; height: 60px; object-fit: cover;">
                  <div>
                    <strong>{{ item.product.name }}</strong><br>
                    Qty: {{ item.quantity }}<br>
                    {% if item.is_reading %}
                      <small>{{ item.duration }} min on {{ item.date }} at {{ item.time }}</small>
                    {% endif %}
                  </div>
                </div>
                <div class="text-end">
                  ${{ item.subtotal|floatformat:2 }}
                </div>
              </li>
            {% endfor %}
          </ul>
          <div class="text-end mt-3 fs-5 fw-bold">
            Total: ${{ total|floatformat:2 }}
          </div>
        {% else %}
          <p class="text-warning">Your bag is empty.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
