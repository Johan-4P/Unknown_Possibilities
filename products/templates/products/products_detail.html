{% extends "base.html" %}
{% load static %}

{% block extra_title %} | {{ product.name }} {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/products.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-5 pt-5 fade-in-section">

  <!-- Product info -->
  <div class="row align-items-center position-relative">
    <div class="col-md-6 mb-4 mb-md-0 text-md-end position-relative">
      {% if product.stock == 0 %}
      <div class="badge-out-of-stock">Out of Stock</div>
      {% endif %}
      <img src="{{ product.image.url }}" class="img-fluid rounded shadow-lg product-image" alt="{{ product.name }}">
    </div>
    <div class="col-md-6 text-light d-flex flex-column justify-content-center">
      <h2 class="display-5">{{ product.name }}</h2>
      <p>${{ product.price|floatformat:2 }}</p>
      <p>{{ product.description }}</p>
      {% if product.category.name|lower == "readings" %}
      <div class="form-group">
        <label for="date">Choose date:</label>
        <input type="date" name="date" class="form-control" required>
      </div>
      <div class="form-group">
        <label for="time">Choose time:</label>
        <input type="time" name="time" class="form-control" required>
      </div>
    {% endif %}
    
      {% if product.stock > 0 %}
      <form method="POST" action="{% url 'add_to_bag' product.id %}" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="redirect_url" value="{{ request.path }}">
        <div class="form-group d-flex align-items-center">
          <label for="quantity" class="me-2">Quantity</label>
          <input type="number" name="quantity" value="1" min="1" class="form-control w-25">
        </div>
        <button type="submit" class="btn btn-own-style mt-2">Add to Cart</button>
      </form>
      {% else %}
      <p class="text-danger fw-bold mt-3">Out of Stock</p>
      {% endif %}
    </div>
  </div>

  <!-- Card of the Day -->
  {% if product.category.name|lower == "tarotcards" and user.is_authenticated %}
  {% include "includes/card_draw.html" %}
{% endif %}

</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/card-of-the-day.js' %}"></script>
{% endblock %}
